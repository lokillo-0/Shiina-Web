<#include "/assets/base.html">

    <div class="container mb-4">
        <div class="card rounded">
            <div class="bg-gradient rounded position-relative"
                style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                <div class="row p-4 position-relative">

                    <div class="col-12 col-md-3 d-flex justify-content-center align-items-center mb-3 mb-md-0">
                        <div class="position-relative">
                            <i class="fa-solid fa-user-group shiina-doc-font-size"></i>
                        </div>
                    </div>

                    <div class="col-12 col-md-9 d-flex flex-column justify-content-center text-white">
                        <h2 class="display-5 py-3 fw-bold mb-2">
                            Relationships
                        </h2>
                    </div>

                </div>
            </div>

            <div class="card-body bg-body px-4 py-3">
                <div class="relationship-body card-body px-4">
            <#if error??>
                <div class="relationship-alert-error alert alert-danger alert-dismissible fade show" role="alert">
                    ${error}
                    <button type="button" class="relationship-alert-close btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            </#if>
            <#if info??>
                <div class="relationship-alert-info alert alert-primary alert-dismissible fade show" role="alert">
                    ${info}
                    <button type="button" class="relationship-alert-close btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            </#if>

            <#if relations?has_content>
                <div class="relationship-grid row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                    <#list relations as relation>
                    <div class="rel-item col">
                        <a href="/u/${relation.id?c}" class="text-decoration-none">
                            <div class="osu-relation-card" 
                                 style="background: rgba(0,0,0,0.1); transition: all 0.2s ease;"
                                 onmouseover="this.style.background='rgba(255,255,255,0.1)'; this.style.transform='translateY(-3px)';"
                                 onmouseout="this.style.background='rgba(0,0,0,0.1)'; this.style.transform='translateY(0px)';">

                                <!-- Status Badge -->
                                <div class="relation-status-badge">
                                    <#if relation.relationship_status == "mutual">
                                        <span class="status-badge mutual-badge">
                                            <i class="fas fa-heart me-1"></i> Mutual
                                        </span>
                                    <#elseif relation.relationship_status == "known">
                                        <span class="status-badge following-badge">
                                            <i class="fas fa-user-check me-1"></i> Following
                                        </span>
                                    <#else>
                                        <span class="status-badge follower-badge">
                                            <i class="fas fa-user-plus me-1"></i> Follower
                                        </span>
                                    </#if>
                                </div>
                                
                                <!-- User Info -->
                                <div class="relation-user-info">
                                    <div class="relation-avatar ">
                                        <img class="rounded" src="${avatarServer}/${relation.id?c}" alt="${relation.name}">
                                    </div>
                                    
                                    <div class="relation-name <#if relation.supporter>supporter</#if>">
                                        ${relation.name}
                                    </div>
                                    
                                    <div class="relation-groups">
                                        <#list relation.user.groups as group>
                                            <span class="badge shiina-badge bg-light bg-opacity-25 text-white py-2 rounded-pill pe-3">
                                                <span class="groupEmoji me-2">${group.emoji}</span>
                                                ${group.name}
                                            </span>
                                        </#list>
                                    </div>
                                    
                                    <div class="relation-timestamp">
                                        <i class="fa-regular fa-clock me-1"></i>
                                        <span data-timestamp-format="unix" data-timestamp="${relation.latest_activity?c}"></span>
                                    </div>
                                </div>
                                
                                <!-- Action Button -->
                                <div class="relation-action" onclick="event.preventDefault(); event.stopPropagation();">
                                    <#if relation.relationship_status == "follower">
                                        <button class="relation-btn follow-btn" 
                                                data-user="${relation.id?c}"
                                                data-shiina-call="relationship">
                                            <i class="fas fa-user-plus me-1"></i> Follow Back
                                        </button>
                                    <#elseif relation.relationship_status == "mutual">
                                        <button class="relation-btn unmutual-btn" 
                                                data-user="${relation.id?c}"
                                                data-shiina-call="relationship">
                                            <i class="fas fa-heart-crack me-1"></i> Unmutual
                                        </button>
                                    <#else>
                                        <button class="relation-btn unfollow-btn" 
                                                data-user="${relation.id?c}"
                                                data-shiina-call="relationship">
                                            <i class="fas fa-user-xmark me-1"></i> Unfollow
                                        </button>
                                    </#if>
                                </div>
                            </div>
                        </a>
                    </div>
                </#list>
                </div>
            <#else>
                <div class="relationship-empty text-center py-5">
                    <h5 class="relationship-empty-text text-muted">You don't have any relationships yet.</h5>
                </div>
            </#if>
        </div>
            </div>
        
        </div>
    </div>



<#include "/assets/footer.html">